function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints}if("undefined"==typeof jQuery)throw Error("jQuery Orderable: I require jQuery to work! Make sure you load me after jQuery.");!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),+function(e){e.fn.orderable=function(t){function n(t,n){if(void 0===t||!t.length)throw Error("jQuery Ordable: Supplied table doesn't exist!");if(!e(t).is("table"))throw Error("jQuery Orderable: I work on <table> delements only. Supplied element: "+t.tagName);e(t).addClass(b.ORDERABLE).attr("ondragstart","return false;"),e(t).find(n.unit).addClass(b.ORDERABLE_UNIT),e(document).on({mouseenter:function(){e(".jq-orderable .hovered").removeClass("hovered"),e(this).addClass("hovered")}},".jq-orderable.reordering "+n.unit),e(document).on("touchmove mousemove",function(t){t.changedTouches||t.originalEvent.changedTouches?(t.changedTouches&&(E=t.changedTouches[t.changedTouches.length-1].pageY),t.originalEvent.changedTouches&&(E=t.originalEvent.changedTouches[t.originalEvent.changedTouches.length-1].pageY)):E=t.pageY,e(".moving")[0]&&l()}),c("onInit"),document.dispatchEvent(new CustomEvent(f.initiated))}function r(t){if(isTouchDevice()&&h.useHandlerOnTouch===!0){!e(".touch-move-row").length&&console.error("jQuery Orderable: 'useHandlerOnTouch' is set to true but no drag handlers were found! Use the '.touch-move-row' class to mark an element as a handler.");var n=".jq-orderable "+h.unit+":not(.orderable-exclude) td:not(.orderable-exclude) .touch-move-row"}else var n=".jq-orderable "+h.unit+":not(.orderable-exclude) td:not(.orderable-exclude)";e(e(t.target).closest(isTouchDevice()?".touch-move-row":"td")).is(n)&&($draggedUnit=e(t.target).parents(h.unit)[0],o(),e($draggedUnit).parents("table").addClass(b.REORDERING),e($draggedUnit).css({top:$draggedUnit.getBoundingClientRect().top,left:$draggedUnit.getBoundingClientRect().left,width:e($draggedUnit).width()}),e($draggedUnit).addClass(b.MOVING),e($draggedUnit).find("tr:visible").addClass("orderable-row-as-table"),l(),c("onOrderStart"),document.dispatchEvent(new CustomEvent(f.ORDERING_STARTED)))}function o(){var t=e(h.unit,g).first();v=e(t).clone(),v.find("td").empty(),v.addClass("orderable-ghost").css("display","").css("background","").insertBefore(t)}function d(){if(e("."+b.MOVING).length){var t=e("."+b.MOVING)[0].getBoundingClientRect(),n=t.left+20,r=t.top,o=t.bottom,d=i(n,r);if(!a(d)){var s=i(n,o);if(!a(s))return u(),c("onOrderCancel"),void document.dispatchEvent(new CustomEvent(f.ORDERING_CANCELLED))}e($draggedUnit).insertAfter(s?e(s).is(".orderable-ghost")?s:s:d),e($draggedUnit).addClass("added"),setTimeout(function(){e($draggedUnit).removeClass("added")},1e3),u(),c("onOrderFinish"),document.dispatchEvent(new CustomEvent(f.ORDERING_FINISHED,{detail:$draggedUnit}))}}function a(t){return e(t).is(h.unit)&&!e(t).parent("thead").length&&e(t).parents(".jq-orderable").length}function i(t,n){var r=document.elementFromPoint(t,n);return e(r).is("tr")||e(r).is("tbody")||(r=e(r).parents(h.unit)),e(r).is("tbody")?r:e(r).is("tr")?"tbody"==h.unit?r.parentElement:r:void 0}function u(){s([b.MOVING,b.REORDERING,b.HOVERED,"orderable-row-as-table"]),v.remove()}function s(t){var t=t.constructor===Array?t:[t];t.forEach(function(t){e("."+t).removeClass(t)})}function l(){var t=e(".moving")[0].getBoundingClientRect(),n=t.left+20,r=t.top,o=i(n,r);e(".hovered").removeClass("hovered"),e(o).addClass("hovered"),e(".moving").css({top:E-15})}function c(e){h[e]&&(h[e].constructor!==Function?console.error("jQuery Orderable: Supplied value for '"+e+"' is not a function."):h[e]($draggedUnit||void 0))}var g=this;t=t||{};var h={unit:t.useTbodyAsUnit?"tbody":"tbody tr",useHandlerOnTouch:t.useHandlerOnTouch||!1,onLoad:t.onLoad,onInit:t.onInit,onOrderStart:t.onOrderStart,onOrderCancel:t.onOrderCancel,onOrderFinish:t.onOrderFinish};$draggedUnit={};var v,E,m={MOUSEDOWN:"mousedown touchstart",MOUSEUP:"mouseup touchend"},b={ORDERABLE:"jq-orderable",ORDERABLE_UNIT:"jq-orderable-unit",MOVING:"moving",HOVERED:"hovered",REORDERING:"reordering"},f={LOADED:"jquery.orderable.load",INITIATED:"jquery.orderable.init",ORDERING_STARTED:"jquery.orderable.order.start",ORDERING_CANCELLED:"jquery.orderable.order.cancel",ORDERING_FINISHED:"jquery.orderable.order.finish"};return c("onLoad"),document.dispatchEvent(new CustomEvent(f.LOADED)),n(this,h),e(document).on(m.MOUSEDOWN,r),e(document).on(m.MOUSEUP,d),this}}(jQuery);
